{% extends "base.html" %}
{% block title %}{{ article.title|striptags }}{% endblock %}
{% block content %}
<section id="content" class="body">

    <div class="row">
        <div class="col-12 col-md-9">
            <div class="card w-100 my-1">
                <div class="card-body">
                    <h1 class="card-title"><a class="text-body" href="{{ SITEURL }}/{{ article.url }}" rel="bookmark"
                            title="{{ article.title|striptags }}">{{ article.title }}</a>
                    </h1>
                    {% import 'translations.html' as translations with context %}
                    {{ translations.translations_for(article) }}
                    <h6 class="card-subtitle">
                        {{ article.locale_date }}
                        {% if article.authors %}
                        {% for author in article.authors|sort %}
                        <a class="text-secondary" href="{{ SITEURL }}/{{ author.url }}"> {{ author }}</a>
                        {% endfor %}
                        {% endif %}
                    </h6>
                    <p class="card-text">{{ article.content }}</p>
                </div>
                <div class="card-footer text-muted">
                    {% if article.tags %}
                    {% for tag in article.tags %}
                    <a class="badge badge-dark" href="{{ SITEURL }}/{{ tag.url }}">{{ tag|e }}</a>
                    &MediumSpace;
                    {% endfor %}
                    {% endif %}
                </div>
            </div>

            {% if DISQUS_SITENAME %}
            <div class="comments">
                <h3>Comments</h3>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    var disqus_identifier = "{{ article.url }}";
                    (function () {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'https://{{ DISQUS_SITENAME }}.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
            </div>
            {% endif %}
            {% if JUVIA_ID %}
            <h3>Comments</h3>
            <div id="comments"></div>
            <script type="text/javascript" class="juvia">
                (function () {
                    var options = {
                        container: '#comments',
                        site_key: '{{ JUVIA_ID }}',
                        topic_key: location.pathname,
                        topic_url: location.href,
                        topic_title: '{{article.title}}',
                        comment_order: 'earliest-first',
                        include_base: !window.Juvia,
                        include_css: !window.Juvia
                    };

                    function makeQueryString(options) {
                        var key, params = [];
                        for (key in options) {
                            params.push(
                                encodeURIComponent(key) +
                                '=' +
                                encodeURIComponent(options[key]));
                        }
                        return params.join('&');
                    }

                    function makeApiUrl(options) {
                        // Makes sure that each call generates a unique URL, otherwise
                        // the browser may not actually perform the request.
                        if (!('_juviaRequestCounter' in window)) {
                            window._juviaRequestCounter = 0;
                        }

                        // or use '//{{ JUVIA_URL }}/api/show_topic.js'
                        // for dynamic switching between http and https
                        var result =
                            '//{{ JUVIA_URL }}/api/show_topic.js' +
                            '?_c=' + window._juviaRequestCounter +
                            '&' + makeQueryString(options);
                        window._juviaRequestCounter++;
                        return result;
                    }

                    var s = document.createElement('script');
                    s.async = true;
                    s.type = 'text/javascript';
                    s.className = 'juvia';
                    s.src = makeApiUrl(options);
                    (document.getElementsByTagName('head')[0] ||
                        document.getElementsByTagName('body')[0]).appendChild(s);
                })();
            </script>
            {% endif %}

        </div>

        {% include 'sidebar.html' %}
    </div>


</section>
{% endblock %}
